### 要完成的事情
1. 更新 `TalkToDemon.js` 文件，確保它能正確處理合併後的歷史紀錄和工具輸出。
2. 確保在處理對話時，能夠正確地組合歷史紀錄和工具輸出，並且在必要時更新歷史紀錄。